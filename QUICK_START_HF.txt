================================================================================
    STAGE 1 TRAINING - HUGGING FACE TRANSFORMERS
    Quick Reference Card
================================================================================

ALWAYS RUN FIRST:
    cd /home/UWO/zjing29/workdir/DQ-Former
    source local.env.sh

--------------------------------------------------------------------------------
QUICK START (Test Mode):
--------------------------------------------------------------------------------
    bash scripts/training/stage_1_dqw2d_hf.sh

--------------------------------------------------------------------------------
FULL TRAINING:
--------------------------------------------------------------------------------
    bash scripts/training/stage_1_dqw2d_hf_full.sh

--------------------------------------------------------------------------------
CUSTOMIZE GPUs:
--------------------------------------------------------------------------------
    Edit the script and change:
    export GPUs="6,7"  # Change to your GPU IDs
    export MASTER_PORT=29500  # Change if port is in use

--------------------------------------------------------------------------------
DEEPSPEED LAUNCH (Direct):
--------------------------------------------------------------------------------
    # Test mode
    deepspeed --master_port 29500 --include localhost:6,7 \
        stage1_hf.py \
        --train_config_path configs/stage1_dqw2d/train_config.yaml \
        --data_config_path configs/stage1_dqw2d/data_config.yaml \
        --test_mode

    # Full training
    deepspeed --master_port 29500 --include localhost:6,7 \
        stage1_hf.py \
        --train_config_path configs/stage1_dqw2d/train_config.yaml \
        --data_config_path configs/stage1_dqw2d/data_config.yaml

--------------------------------------------------------------------------------
VALIDATION TEST:
--------------------------------------------------------------------------------
    python test_stage1_hf.py

--------------------------------------------------------------------------------
FILES CREATED:
--------------------------------------------------------------------------------
    CODE:
        - stage1_hf.py                          (Main training script)
        - trainer/stage1_hf.py                  (Model definition)
        - scripts/training/stage_1_dqw2d_hf.sh  (Launch script)
        - test_stage1_hf.py                     (Validation test)
    
    DOCS:
        - STAGE1_HF_README.md                   (User guide)
        - MIGRATION_GUIDE_STAGE1_HF.md          (Migration details)
        - STAGE1_CODE_COMPARISON.md             (Code comparison)
        - CONVERSION_SUMMARY.md                 (This conversion summary)
        - QUICK_START_HF.txt                    (This file)

--------------------------------------------------------------------------------
MONITORING:
--------------------------------------------------------------------------------
    WandB:       Project: stage1_v2 (offline mode)
    TensorBoard: tensorboard --logdir checkpoints/stage1_dqw2d_v2/logs
    GPU:         watch -n 1 nvidia-smi

--------------------------------------------------------------------------------
CHECKPOINTS:
--------------------------------------------------------------------------------
    Location: checkpoints/stage1_dqw2d_v2/
        - checkpoint-{step}/    (periodic saves)
        - final_model/          (final model)

--------------------------------------------------------------------------------
TROUBLESHOOTING:
--------------------------------------------------------------------------------
    Import errors?          → source local.env.sh
    BASE_DIR not set?       → source local.env.sh
    Out of memory?          → Reduce batch_size in data_config.yaml
    No checkpoints saving?  → Check disk space and permissions

--------------------------------------------------------------------------------
CONFIGURATION:
--------------------------------------------------------------------------------
    Training:  configs/stage1_dqw2d/train_config.yaml
    Data:      configs/stage1_dqw2d/data_config.yaml
    DeepSpeed: configs/deepspeed/ds_config_zero{2,3}.json
    GPUs:      Edit CUDA_VISIBLE_DEVICES in shell script
    
    To use DeepSpeed Stage 3 (for larger models):
        Add to train_config.yaml:  deepspeed_stage: 3

--------------------------------------------------------------------------------
KEY FEATURES:
--------------------------------------------------------------------------------
    ✓ DQ-Former encoder support
    ✓ Flash Attention support
    ✓ Blending module support
    ✓ BRICS/Entropy GIDs support
    ✓ Custom warmup + cosine LR schedule
    ✓ Mixed precision (bf16/fp16)
    ✓ DeepSpeed Stage 2
    ✓ Multi-GPU training
    ✓ Auto checkpoint resume
    ✓ WandB & TensorBoard logging

--------------------------------------------------------------------------------
NEXT STEPS:
--------------------------------------------------------------------------------
    1. Source environment:     source local.env.sh
    2. Run validation:         python test_stage1_hf.py
    3. Test training:          bash scripts/training/stage_1_dqw2d_hf.sh
    4. Monitor metrics:        Check WandB/TensorBoard
    5. Full training:          Remove --test_mode and rerun

--------------------------------------------------------------------------------
REMEMBER: Always run "source local.env.sh" first!
--------------------------------------------------------------------------------

For detailed documentation, see:
    - STAGE1_HF_README.md           (Start here!)
    - MIGRATION_GUIDE_STAGE1_HF.md  (Technical details)
    - CONVERSION_SUMMARY.md         (Overview)

================================================================================

